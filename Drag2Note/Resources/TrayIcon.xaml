<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:tb="http://www.hardcodet.net/taskbar">

    <!-- Style for ContextMenu with rounded corners -->
    <Style x:Key="TrayContextMenuStyle" TargetType="ContextMenu">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="OverridesDefaultStyle" Value="True"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ContextMenu">
                    <Border Background="{DynamicResource WindowBackground}" 
                            BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" 
                            CornerRadius="8" Padding="4">
                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Style for MenuItem with rounded corners on hover -->
    <Style x:Key="TrayMenuItemStyle" TargetType="MenuItem">
        <Setter Property="Padding" Value="10,8"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="MenuItem">
                    <Border x:Name="Border" Background="Transparent" CornerRadius="6" Padding="{TemplateBinding Padding}">
                        <ContentPresenter ContentSource="Header" TextElement.Foreground="{TemplateBinding Foreground}"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsHighlighted" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{DynamicResource MenuItemHover}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <ContextMenu x:Key="TrayMenu" Style="{StaticResource TrayContextMenuStyle}">
        <MenuItem Header="切换主窗口" Command="{Binding OpenMainWindowCommand}" Style="{StaticResource TrayMenuItemStyle}" />
        <MenuItem Header="切换悬浮窗" Command="{Binding ToggleFloatingWindowCommand}" Style="{StaticResource TrayMenuItemStyle}" />
        <MenuItem Header="设置" Command="{Binding OpenSettingsCommand}" Style="{StaticResource TrayMenuItemStyle}" />
        <MenuItem Header="退出" Command="{Binding ExitCommand}" Style="{StaticResource TrayMenuItemStyle}" />
    </ContextMenu>

    <tb:TaskbarIcon x:Key="TrayIcon"
                    ToolTipText="Drag2Note-Lite"
                    IconSource="/Icons/icon.ico"
                    ContextMenu="{StaticResource TrayMenu}"
                    MenuActivation="RightClick"
                    DoubleClickCommand="{Binding ToggleFloatingWindowCommand}">
    </tb:TaskbarIcon>

</ResourceDictionary>
